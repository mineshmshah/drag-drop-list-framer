{"ast":null,"code":"import { clamp, distance } from \"@popmotion/popcorn\";\n// Prevent rapid reverse swapping\nvar buffer = 5;\nexport var findIndex = function findIndex(i, yOffset, positions) {\n  var target = i;\n  var _positions$i = positions[i],\n      top = _positions$i.top,\n      height = _positions$i.height;\n  var bottom = top + height; // If moving down\n\n  if (yOffset > 0) {\n    var nextItem = positions[i + 1];\n    if (nextItem === undefined) return i;\n    var swapOffset = distance(bottom, nextItem.top + nextItem.height / 2) + buffer;\n    if (yOffset > swapOffset) target = i + 1; // If moving up\n  } else if (yOffset < 0) {\n    var prevItem = positions[i - 1];\n    if (prevItem === undefined) return i;\n    var prevBottom = prevItem.top + prevItem.height;\n\n    var _swapOffset = distance(top, prevBottom - prevItem.height / 2) + buffer;\n\n    if (yOffset < -_swapOffset) target = i - 1;\n  }\n\n  return clamp(0, positions.length, target);\n};","map":{"version":3,"sources":["/Users/mineshshah/minesh/drag-drop-list-framer/src/find-index.ts"],"names":["clamp","distance","buffer","findIndex","i","yOffset","positions","target","top","height","bottom","nextItem","undefined","swapOffset","prevItem","prevBottom","length"],"mappings":"AAAA,SAASA,KAAT,EAAgBC,QAAhB,QAAgC,oBAAhC;AAQA;AACA,IAAMC,MAAM,GAAG,CAAf;AAEA,OAAO,IAAMC,SAAS,GAAG,SAAZA,SAAY,CACvBC,CADuB,EAEvBC,OAFuB,EAGvBC,SAHuB,EAIpB;AACH,MAAIC,MAAM,GAAGH,CAAb;AADG,qBAEqBE,SAAS,CAACF,CAAD,CAF9B;AAAA,MAEKI,GAFL,gBAEKA,GAFL;AAAA,MAEUC,MAFV,gBAEUA,MAFV;AAGH,MAAMC,MAAM,GAAGF,GAAG,GAAGC,MAArB,CAHG,CAKH;;AACA,MAAIJ,OAAO,GAAG,CAAd,EAAiB;AACf,QAAMM,QAAQ,GAAGL,SAAS,CAACF,CAAC,GAAG,CAAL,CAA1B;AACA,QAAIO,QAAQ,KAAKC,SAAjB,EAA4B,OAAOR,CAAP;AAE5B,QAAMS,UAAU,GACdZ,QAAQ,CAACS,MAAD,EAASC,QAAQ,CAACH,GAAT,GAAeG,QAAQ,CAACF,MAAT,GAAkB,CAA1C,CAAR,GAAuDP,MADzD;AAEA,QAAIG,OAAO,GAAGQ,UAAd,EAA0BN,MAAM,GAAGH,CAAC,GAAG,CAAb,CANX,CAQf;AACD,GATD,MASO,IAAIC,OAAO,GAAG,CAAd,EAAiB;AACtB,QAAMS,QAAQ,GAAGR,SAAS,CAACF,CAAC,GAAG,CAAL,CAA1B;AACA,QAAIU,QAAQ,KAAKF,SAAjB,EAA4B,OAAOR,CAAP;AAE5B,QAAMW,UAAU,GAAGD,QAAQ,CAACN,GAAT,GAAeM,QAAQ,CAACL,MAA3C;;AACA,QAAMI,WAAU,GAAGZ,QAAQ,CAACO,GAAD,EAAMO,UAAU,GAAGD,QAAQ,CAACL,MAAT,GAAkB,CAArC,CAAR,GAAkDP,MAArE;;AACA,QAAIG,OAAO,GAAG,CAACQ,WAAf,EAA2BN,MAAM,GAAGH,CAAC,GAAG,CAAb;AAC5B;;AAED,SAAOJ,KAAK,CAAC,CAAD,EAAIM,SAAS,CAACU,MAAd,EAAsBT,MAAtB,CAAZ;AACD,CA7BM","sourcesContent":["import { clamp, distance } from \"@popmotion/popcorn\";\n\nexport interface Position {\n  top: number;\n  height: number;\n  child?: any\n}\n\n// Prevent rapid reverse swapping\nconst buffer = 5;\n\nexport const findIndex = (\n  i: number,\n  yOffset: number,\n  positions: Position[]\n) => {\n  let target = i;\n  const { top, height } = positions[i];\n  const bottom = top + height;\n\n  // If moving down\n  if (yOffset > 0) {\n    const nextItem = positions[i + 1];\n    if (nextItem === undefined) return i;\n\n    const swapOffset =\n      distance(bottom, nextItem.top + nextItem.height / 2) + buffer;\n    if (yOffset > swapOffset) target = i + 1;\n\n    // If moving up\n  } else if (yOffset < 0) {\n    const prevItem = positions[i - 1];\n    if (prevItem === undefined) return i;\n\n    const prevBottom = prevItem.top + prevItem.height;\n    const swapOffset = distance(top, prevBottom - prevItem.height / 2) + buffer;\n    if (yOffset < -swapOffset) target = i - 1;\n  }\n\n  return clamp(0, positions.length, target);\n};\n"]},"metadata":{},"sourceType":"module"}